#!/bin/bash

icons=$HOME/.config/eww/bar/icons/volume
vol=$(pactl list sinks | grep "Volume" | grep -hEo "[[:digit:]]{1,3}%" | head -1 | grep -o "[^%]" | tr -d '\n')
mute=$(pactl list sinks | grep "Mute" | grep -Eo "(yes|no)")

icon() {

if [ "$mute" == "yes" ]; then
        icon=${icons}/volume-off.svg
elif [ "$vol" -gt "66" ]; then
	icon=${icons}/volume-high.svg
	sed -i "s/.st0{fill:none;stroke:#[A-F0-9]*;/.st0{fill:none;stroke:#9900FF;/" $icon
elif [ "$vol" -gt "33" ]; then
	icon=${icons}/volume.svg
	sed -i "s/.st0{fill:none;stroke:#[A-F0-9]*;/.st0{fill:none;stroke:#9900FF;/" $icon
       	sed -i "s/.st1{fill:none;stroke:#[A-F0-9]*;/.st1{fill:none;stroke:#DDABFF;/" $icon
elif [ "$vol" -ge "0" ]; then
        icon=${icons}/volume-low.svg
	sed -i "s/.st0{fill:none;stroke:#[A-F0-9]*;/.st0{fill:none;stroke:#9900FF;/" $icon
	sed -i "s/.st1{fill:none;stroke:#[A-F0-9]*;/.st1{fill:none;stroke:#DDABFF;/" $icon

fi
echo "$icon"
}

percent() {
echo "$vol"
}

[ "$1" = "icon" ] && icon && exit
[ "$1" = "percent" ] && percent && exit
exit
